#!/bin/sh
# -*- mode: sh -*-

SPLINT=@SPLINT@

if ! test -x ${SPLINT}; then
	echo "SPLINT not found" >&2
	exit 1
fi

STDOUT=`mktemp` || exit 1
STDERR=`mktemp` || exit 1
trap 'rm -f $STDOUT $STDERR' INT QUIT TERM EXIT

${SPLINT}  $* 2>$STDERR >$STDOUT

if egrep '(Cannot find include file|Parse Error)' $STDERR; then
	cat $STDERR >&2;
	cat $STDOUT >&2;
	cat $STDERR
	cat $STDOUT
	exit 1
fi

cat $STDERR
cat $STDOUT
