.\"	$OpenBSD: mdoc.template,v 1.9 2004/07/02 10:36:57 jmc Exp $
.\"
.\" Copyright (c) 2007 GeNUA mbH <info@genua.de>
.\"
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
.\" "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
.\" LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
.\" A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
.\" OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
.\" SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
.\" TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
.\" PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
.\" LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
.\" NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
.\" SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" The following requests are required for all man pages.
.Dd October 16, 2007
.Dt DEV-ANOUBIS 4
.Os Anoubis
.Sh NAME
.Nm anoubis
.Nd Anoubis configuration device
.Sh SYNOPSIS
.Cd "pseudo-device anoubis"
.Sh DESCRIPTION
The
.Nm
device allows user space to configure the anoubis kernel components.
This device is under development and supported operations may change
without notice.
.Pp
Currently the device supports the following ioctl(2)s:
.Bl -tag -width "XXXX"
.It ANOUBIS_DECLARE_FD
The argument of this ioctl(2) is an integer that is interpreted as a
file descriptor.
This file descriptor must be associated with an eventdev(4) queue, i.e. it
must have been created by opening /dev/eventdev.
In this case the eventdev(4) queue associated with the file descriptor
is registered with the ANOUBIS subsystem and any events produced by
ANOUBIS are queued on this queue from now on.
This command requires root privileges and it is not allowed if a queue
is already registered.
.It ANOUBIS_UNDECLARE_FD
This is the opposite of ANOUBIS_DECLARE_FD.
This ioctl(2) deregisters the eventdev queue associated with the file
descriptor given as the ioctl argument.
The file descriptor must be given here for security reasons, if it does
not match the current anoubis event queue, the operation will fail.
.It ANOUBIS_DECLARE_LISTENER
Tell the anoubis kernel that the current process is responsible for
answering anoubis events and should thus not be blocked on events itself.
This command requires root privileges and for security reasons the
argument of the ioctl(2) must be an open file descriptor that points
to the current anoubis queue.
.It ANOUBIS_REQUEST_STATS
Request system status statistics from the kernel.
The statistics are sent to the anoubis queue in the form of a notify event.
.It ANOUBIS_GETVERSION
Retrieve the current anoubis core interface version used by the kernel.
This is useful for user land processes that want to make sure that they
are compatible with the kernel they try to communicate with.
.It ANOUBIS_GETCSUM
The argument to this ioctl(2) is a pointer to a struct anoubis_ioctl_csum.
The fd field in that structure must be an open file descriptor in the
calling process.
The kernel will fill in the csum field of the structure with the
checksum of the file given by the fd field.
.El
.Sh NOTE
The modified queue is effective for all events that are generated
after the ioctl(2).
This also applies to events that are generated by system calls which are
already in progress.
.Sh SEE ALSO
eventdev(4)
.Sh AUTHORS
Christian Ehrhardt
